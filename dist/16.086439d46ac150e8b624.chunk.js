webpackJsonp([16],{138:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=t(179),a=t(210),o=t(0),i=o(r.a,a.a,!1,null,null,null);i.options.__file="src\\views\\user\\info.vue",s.default=i.exports},179:function(e,s,t){"use strict";var r=t(50),a=t.n(r),o=t(4);s.a={name:"ownspace_index",data:function(){var e=this;return{userForm:{},uid:"",securityCode:"",phoneHasChanged:!1,save_loading:!1,identifyError:"",editPasswordModal:!1,savePassLoading:!1,oldPassError:"",identifyCodeRight:!1,hasGetIdentifyCode:!1,canGetIdentifyCode:!1,checkIdentifyCodeLoading:!1,inforValidate:{user_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],cellphone:[{required:!0,message:"请输入手机号码"},{validator:function(e,s,t){/^1[0-9]{10}$/.test(s)?t():t(new Error("请输入正确格式的手机号"))}}]},editPasswordForm:{oldPass:"",newPass:"",rePass:""},passwordValidate:{oldPass:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],rePass:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:function(s,t,r){t!==e.editPasswordForm.newPass?r(new Error("两次输入密码不一致")):r()},trigger:"blur"}]},inputCodeVisible:!1,initPhone:"",gettingIdentifyCodeBtnContent:"获取验证码"}},methods:{showEditPassword:function(){this.editPasswordModal=!0},saveEdit:function(){var e=this;this.$refs.userForm.validate(function(s){s&&(e.phoneHasChanged&&e.userForm.cellphone!==e.initPhone?e.hasGetIdentifyCode?e.identifyCodeRight?e.saveInfoAjax():e.$Message.error("验证码错误，请重新输入"):e.$Message.warning("请先点击获取验证码"):e.saveInfoAjax())})},cancelEditPass:function(){this.editPasswordModal=!1},saveEditPass:function(){var e=this;this.$refs.editPasswordForm.validate(function(s){if(s){e.savePassLoading=!0;var t={user_name:e.userForm.user_phone?e.userForm.user_phone:e.userForm.user_email,user_psd:a()(e.editPasswordForm.newPass),user_old_psd:a()(e.editPasswordForm.oldPass)};e.$fetch.user.change_psd(t).then(function(s){200===s.code?(e.savePassLoading=!1,e.editPasswordModal=!1,e.$Message.success(s.msg)):(e.savePassLoading=!1,e.$Message.error(s.msg))})}})},init:function(){this.userForm=o.a.cloneObj(this.$store.state.user.info)},cancelInputCodeBox:function(){this.inputCodeVisible=!1,this.userForm.cellphone=this.initPhone},hasChangePhone:function(){this.phoneHasChanged=!0,this.hasGetIdentifyCode=!1,this.identifyCodeRight=!1},saveInfoAjax:function(){var e=this;this.save_loading=!0,this.$fetch.user.edit({user_id:this.userForm.user_id,user_name:this.userForm.user_name,user_sign:this.userForm.user_sign}).then(function(s){e.save_loading=!1,200===s.code?(e.$Message.success("保存成功"),e.$store.commit("setEditUser",s.data)):e.$Message.error(s.msg)})}},mounted:function(){this.init()}}},210:function(e,s,t){"use strict";var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":100,"label-position":"right",rules:e.inforValidate}},[t("FormItem",{attrs:{label:"用户昵称：",prop:"user_name"}},[t("div",{staticStyle:{display:"inline-block",width:"300px"}},[t("Input",{model:{value:e.userForm.user_name,callback:function(s){e.$set(e.userForm,"user_name",s)},expression:"userForm.user_name"}})],1)]),e._v(" "),t("FormItem",{attrs:{label:"手机："}},[e.userForm.user_phone?t("Row",[t("Col",{attrs:{span:"12"}},[e._v(e._s(e._f("formatPhone")(e.userForm.user_phone)))]),e._v(" "),t("Col",{attrs:{span:"12"}},[t("Button",{attrs:{type:"text"}},[e._v("修改")])],1)],1):t("Row",[t("Col",{attrs:{span:"12"}},[e._v("未绑定")]),e._v(" "),t("Col",{attrs:{span:"12"}},[t("Button",{attrs:{type:"text"}},[e._v("绑定")])],1)],1)],1),e._v(" "),t("FormItem",{attrs:{label:"邮箱："}},[e.userForm.user_email?t("Row",[t("Col",{attrs:{span:"12"}},[e._v(e._s(e.userForm.user_email))]),e._v(" "),t("Col",{attrs:{span:"12"}},[t("Button",{attrs:{type:"text"}},[e._v("修改")])],1)],1):t("Row",[t("Col",{attrs:{span:"12"}},[e._v("未绑定")]),e._v(" "),t("Col",{attrs:{span:"12"}},[t("Button",{attrs:{type:"text"}},[e._v("绑定")])],1)],1)],1),e._v(" "),t("FormItem",{attrs:{label:"性别："}},[t("span",[e._v(e._s(e.userForm.user_sex))])]),e._v(" "),t("FormItem",{attrs:{label:"学校："}},[t("span",[e._v(e._s(e.userForm.user_sid))])]),e._v(" "),t("FormItem",{attrs:{label:"二龄："}},[t("span",[e._v(e._s(e.userForm.user_rtime))])]),e._v(" "),t("FormItem",{attrs:{label:"上次登录："}},[t("span",[e._v(e._s(e.userForm.user_ltime))])]),e._v(" "),t("FormItem",{attrs:{label:"登录密码："}},[t("Button",{attrs:{type:"text",size:"small"},on:{click:e.showEditPassword}},[e._v("修改密码")])],1),e._v(" "),t("FormItem",{attrs:{label:"个性签名"}},[t("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请填写个性签名"},model:{value:e.userForm.user_sign,callback:function(s){e.$set(e.userForm,"user_sign",s)},expression:"userForm.user_sign"}})],1),e._v(" "),t("div",[t("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.save_loading,long:""},on:{click:e.saveEdit}},[e._v("保存")])],1),e._v(" "),t("Modal",{attrs:{closable:!1,"mask-closable":!1,width:500},model:{value:e.editPasswordModal,callback:function(s){e.editPasswordModal=s},expression:"editPasswordModal"}},[t("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("修改密码")]),e._v(" "),t("Form",{ref:"editPasswordForm",attrs:{model:e.editPasswordForm,"label-width":100,"label-position":"right",rules:e.passwordValidate}},[t("FormItem",{attrs:{label:"原密码",prop:"oldPass",error:e.oldPassError}},[t("Input",{attrs:{placeholder:"请输入现在使用的密码"},model:{value:e.editPasswordForm.oldPass,callback:function(s){e.$set(e.editPasswordForm,"oldPass",s)},expression:"editPasswordForm.oldPass"}})],1),e._v(" "),t("FormItem",{attrs:{label:"新密码",prop:"newPass"}},[t("Input",{attrs:{placeholder:"请输入新密码，至少6位字符"},model:{value:e.editPasswordForm.newPass,callback:function(s){e.$set(e.editPasswordForm,"newPass",s)},expression:"editPasswordForm.newPass"}})],1),e._v(" "),t("FormItem",{attrs:{label:"确认新密码",prop:"rePass"}},[t("Input",{attrs:{placeholder:"请再次输入新密码"},model:{value:e.editPasswordForm.rePass,callback:function(s){e.$set(e.editPasswordForm,"rePass",s)},expression:"editPasswordForm.rePass"}})],1)],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancelEditPass}},[e._v("取消")]),e._v(" "),t("Button",{attrs:{type:"primary",loading:e.savePassLoading},on:{click:e.saveEditPass}},[e._v("保存")])],1)],1)],1)},a=[];r._withStripped=!0;var o={render:r,staticRenderFns:a};s.a=o}});